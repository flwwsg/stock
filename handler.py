
import pandas as pd
from pandas import Series
from pandas.tseries.offsets import BDay
import tushare as ts

labels = ['银华领先策略', '鹏华品牌传承', '前海开源沪港', '鹏华消费优选', '博时沪港深价', '银华富裕主题', '博时沪港深价', '交银稳健配置', '天弘周期策略', '银华盛世精选', '富国沪港深价', '广发竞争优势', '银华中小盘混', '中海沪港深价', '万家新利灵活', '交银趋势混合', '易方达改革红', '宝盈优势产业', '华安沪港深通', '民生加银内需', '民生加银城镇', '农银行业领先', '广发聚富', '农银策略精选', '景顺长城鼎益', '华安媒体互联', '万家精选混合', '银华价值优选', '农银汇理国企', '景顺长城新兴', '东方红沪港深', '华泰柏瑞新经', '农银高增长混', '国泰金马稳健', '前海开源事件', '宝盈新锐混合', '汇添富消费行', '前海开源事件', '富国低碳环保', '农银现代农业', '嘉实回报', '前海开源中国', '农银主题轮动', '前海开源沪港', '博时新趋势混', '汇添富成长焦', '富国中小盘精', '泰康沪港深价', '交银沪港深价', '万家瑞兴']

stocks = [{'sz002567': '唐人神', 'sh600021': '上海电力', 'sz300274': '阳光电源', 'sz002640': '跨境通', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600535': '天士力', 'sz300021': '大禹节水', 'sh600809': '山西汾酒', 'sz000967': '盈峰环境'}, {'sh603833': '欧派家居', 'sz002304': '洋河股份', 'sh600779': '水井坊', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz002241': '歌尔股份', 'sz000651': '格力电器', 'sz000799': '酒鬼酒', 'sz002271': '东方雨虹'}, {'sz300083': '劲胜智能', 'sz002241': '歌尔股份', 'sz300207': '欣旺达', 'sz002624': '完美世界', 'sz300450': '先导智能', 'sz300296': '利亚德', 'sz002555': '三七互娱', 'sz000050': '深天马A', 'sz300327': '中颖电子', 'sz002174': '游族网络'}, {'sh603833': '欧派家居', 'sz002304': '洋河股份', 'sh600779': '水井坊', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz002241': '歌尔股份', 'sz000651': '格力电器', 'sz002271': '东方雨虹', 'sz000333': '美的集团'}, {'': '海天国际'}, {'sz000596': '古井贡酒', 'sh600298': '安琪酵母', 'sz002304': '洋河股份', 'sz000423': '东阿阿胶', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sh600559': '老白干酒', 'sz002572': '索菲亚', 'sh600809': '山西汾酒'}, {'': '海天国际'}, {'sh600622': '嘉宝集团', 'sh600056': '中国医药', 'sz000538': '云南白药', 'sh601607': '上海医药', 'sh601012': '隆基股份', 'sh600519': '贵州茅台', 'sh601933': '永辉超市', 'sh600258': '首旅酒店', 'sz002271': '东方雨虹', 'sz000333': '美的集团'}, {'sz002475': '立讯精密', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz000921': '海信科龙', 'sz002008': '大族激光', 'sz002271': '东方雨虹', 'sh600702': '沱牌舍得', 'sz002372': '伟星新材', 'sh600419': '天润乳业'}, {'sz002640': '跨境通', 'sz300274': '阳光电源', 'sz300021': '大禹节水', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sz000997': '新大陆', 'sz000651': '格力电器', 'sz002831': '裕同科技', 'sh603898': '好莱客', 'sz300013': '新宁物流'}, {'': '瑞声科技'}, {'sz002217': '合力泰', 'sh600104': '上汽集团', 'sz000568': '泸州老窖', 'sh600809': '山西汾酒', 'sh600519': '贵州茅台', 'sh600872': '中炬高新', 'sz002456': '欧菲光', 'sz002081': '金螳螂', 'sz002635': '安洁科技', 'sz000333': '美的集团'}, {'sz300274': '阳光电源', 'sz300021': '大禹节水', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sz002831': '裕同科技', 'sz300115': '长盈精密', 'sz000651': '格力电器', 'sh603898': '好莱客', 'sz300013': '新宁物流', 'sz000967': '盈峰环境'}, {'': '港铁公司'}, {'sh601668': '中国建筑', 'sz300197': '铁汉生态', 'sz002146': '荣盛发展', 'sh600048': '保利地产', 'sz001979': '招商蛇口', 'sh600068': '葛洲坝', 'sz002310': '东方园林', 'sh600340': '华夏幸福', 'sh601997': '贵阳银行', 'sh600491': '龙元建设'}, {'sh603808': '歌力思', 'sz002027': '分众传媒', 'sh601318': '中国平安', 'sh600197': '伊力特', 'sz000002': '万科A', 'sh600887': '伊利股份', 'sz000921': '海信科龙', 'sh600036': '招商银行', 'sh603355': '莱克电气', 'sz000858': '五粮液'}, {'sz002019': '亿帆医药', 'sh600779': '水井坊', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh601012': '隆基股份', 'sz002043': '兔宝宝', 'sz000651': '格力电器', 'sz002008': '大族激光', 'sz300393': '中来股份', 'sh600519': '贵州茅台'}, {'sh600622': '嘉宝集团', 'sz002035': '华帝股份', 'sz000568': '泸州老窖', 'sz000333': '美的集团', 'sh600519': '贵州茅台', 'sz001979': '招商蛇口', 'sz000651': '格力电器', 'sz002675': '东诚药业', 'sz002508': '老板电器', 'sz000858': '五粮液'}, {'': '中国联通', 'sz000651': '格力电器', 'sz000700': '模塑科技', 'sh600036': '招商银行'}, {'sh600622': '嘉宝集团', 'sh601336': '新华保险', 'sh601318': '中国平安', 'sz000568': '泸州老窖', 'sh600036': '招商银行', 'sh600535': '天士力', 'sz002583': '海能达', 'sh600566': '济川药业', 'sz002035': '华帝股份', 'sz002508': '老板电器'}, {'sh600622': '嘉宝集团', 'sz000596': '古井贡酒', 'sh601336': '新华保险', 'sz000568': '泸州老窖', 'sh600519': '贵州茅台', 'sh600535': '天士力', 'sz002583': '海能达', 'sh600566': '济川药业', 'sz002035': '华帝股份', 'sz002508': '老板电器'}, {'sh601607': '上海医药', 'sh603179': '新泉股份', 'sh600779': '水井坊', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sh600593': '大连圣亚', 'sz002555': '三七互娱', 'sh603589': '口子窖', 'sz002624': '完美世界'}, {'sz000333': '美的集团', 'sz002217': '合力泰', 'sh600104': '上汽集团', 'sz000568': '泸州老窖', 'sh600809': '山西汾酒', 'sh600519': '贵州茅台', 'sh600872': '中炬高新', 'sz002456': '欧菲光', 'sz002635': '安洁科技', 'sz002081': '金螳螂'}, {'sh601607': '上海医药', 'sh603179': '新泉股份', 'sh600779': '水井坊', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sh600593': '大连圣亚', 'sz002555': '三七互娱', 'sh603589': '口子窖', 'sz002624': '完美世界'}, {'sz000418': '小天鹅A', 'sz002311': '海大集团', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sh603899': '晨光文具', 'sz000423': '东阿阿胶', 'sz000651': '格力电器', 'sh600566': '济川药业', 'sz000333': '美的集团'}, {'sh600030': '中信证券', 'sz300007': '汉威科技', 'sh601688': '华泰证券', 'sh600360': '华微电子', 'sh600549': '厦门钨业', 'sz300365': '恒华科技', 'sh600603': '广汇物流', 'sz000662': '天夏智慧', 'sz300619': '金银河', 'sz002185': '华天科技'}, {'sz300197': '铁汉生态', 'sh600068': '葛洲坝', 'sz002146': '荣盛发展', 'sh600048': '保利地产', 'sz001979': '招商蛇口', 'sz002142': '宁波银行', 'sz002310': '东方园林', 'sh600340': '华夏幸福', 'sh601997': '贵阳银行', 'sh600491': '龙元建设'}, {'sz002567': '唐人神', 'sh601225': '陕西煤业', 'sz002456': '欧菲光', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600535': '天士力', 'sh601668': '中国建筑', 'sz300021': '大禹节水', 'sh600887': '伊利股份', 'sh600068': '葛洲坝'}, {'sh601607': '上海医药', 'sh603179': '新泉股份', 'sh600779': '水井坊', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sh600593': '大连圣亚', 'sz002555': '三七互娱', 'sh603589': '口子窖', 'sz002624': '完美世界'}, {'sz000418': '小天鹅A', 'sz002311': '海大集团', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sh603899': '晨光文具', 'sz000423': '东阿阿胶', 'sz000651': '格力电器', 'sh600566': '济川药业', 'sz000333': '美的集团'}, {'': '安踏体育', 'sh601318': '中国平安', 'sh600196': '复星医药', 'sz000333': '美的集团', 'sh600660': '福耀玻璃', 'sh600887': '伊利股份', 'sz002311': '海大集团', 'sz300408': '三环集团', 'sz002415': '海康威视'}, {'sz000418': '小天鹅A', '': '耐世特', 'sz002304': '洋河股份', 'sh601098': '中南传媒', 'sz002508': '老板电器', 'sz002241': '歌尔股份', 'sz002415': '海康威视', 'sz300433': '蓝思科技', 'sz000538': '云南白药', 'sh600741': '华域汽车'}, {'sz300418': '昆仑万维', 'sz002624': '完美世界', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz002712': '思美传媒', 'sz002555': '三七互娱', 'sz002456': '欧菲光', 'sz002008': '大族激光', 'sz002475': '立讯精密'}, {'sh600056': '中国医药', 'sz000963': '华东医药', 'sz000501': '鄂武商A', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz000651': '格力电器', 'sz002508': '老板电器', 'sz002572': '索菲亚', 'sz000333': '美的集团'}, {'sh601607': '上海医药', 'sz000028': '国药一致', 'sz000538': '云南白药', 'sh600104': '上汽集团', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz000651': '格力电器', 'sh600887': '伊利股份', 'sh600741': '华域汽车'}, {'sz002508': '老板电器', 'sh600622': '嘉宝集团', 'sz002035': '华帝股份', 'sz000596': '古井贡酒', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz001979': '招商蛇口', 'sz000651': '格力电器', 'sz000333': '美的集团'}, {'sz002508': '老板电器', 'sh600661': '新南洋', 'sz000568': '泸州老窖', 'sh600519': '贵州茅台', 'sh601601': '中国太保', 'sz000651': '格力电器', 'sz000921': '海信科龙', 'sz002572': '索菲亚', 'sz000333': '美的集团', 'sz000858': '五粮液'}, {'sh601607': '上海医药', 'sz000028': '国药一致', 'sz000538': '云南白药', 'sh600104': '上汽集团', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz000651': '格力电器', 'sh600887': '伊利股份', 'sh600741': '华域汽车'}, {'sz002640': '跨境通', 'sz002120': '韵达股份', 'sz002035': '华帝股份', 'sz002475': '立讯精密', 'sz300136': '信维通信', 'sz002043': '兔宝宝', 'sz002511': '中顺洁柔', 'sz002572': '索菲亚', 'sz002508': '老板电器', 'sz002127': '南极电商'}, {'sh601888': '中国国旅', 'sz002677': '浙江美大', 'sz002635': '安洁科技', 'sz000063': '中兴通讯', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sz002555': '三七互娱', 'sh600146': '商赢环球', 'sz002103': '广博股份'}, {'sh600298': '安琪酵母', 'sz002241': '歌尔股份', 'sz000820': '神雾节能', 'sz000568': '泸州老窖', 'sz000858': '五粮液', 'sh600519': '贵州茅台', 'sh600559': '老白干酒', 'sz000651': '格力电器', 'sh600068': '葛洲坝', 'sz000596': '古井贡酒'}, {'sh600489': '中金黄金', 'sz002241': '歌尔股份', 'sh600547': '山东黄金', 'sz002155': '湖南黄金', 'sz002555': '三七互娱', 'sz002343': '慈文传媒', 'sh601989': '中国重工', 'sz002174': '游族网络', 'sz000768': '中航飞机', 'sh600685': '中船防务'}, {'sh600622': '嘉宝集团', 'sz000418': '小天鹅A', 'sz002035': '华帝股份', 'sh600383': '金地集团', 'sh600519': '贵州茅台', 'sz002456': '欧菲光', 'sz000651': '格力电器', 'sz000921': '海信科龙', 'sz002127': '南极电商', 'sz002508': '老板电器'}, {'': '北控水务集团', 'sh600104': '上汽集团', 'sz000568': '泸州老窖', 'sh600197': '伊力特', 'sz000998': '隆平高科', 'sz000639': '西王食品', 'sh600201': '生物股份', 'sz300087': '荃银高科', 'sz002568': '百润股份'}, {'sh603286': '日盈电子', 'sz002013': '中航机电', 'sz002879': '长缆科技'}, {'sz000418': '小天鹅A', 'sh600036': '招商银行', 'sz002035': '华帝股份', 'sh601318': '中国平安', 'sz000333': '美的集团', 'sh601601': '中国太保', 'sz000651': '格力电器', 'sz002572': '索菲亚', 'sz002508': '老板电器', 'sz002127': '南极电商'}, {'sh600409': '三友化工', 'sz002050': '三花智控', 'sz000858': '五粮液', 'sh600703': '三安光电', 'sh603799': '华友钴业', 'sh600110': '诺德股份', 'sh601933': '永辉超市', 'sz002008': '大族激光', 'sh603993': '洛阳钼业', 'sz002466': '天齐锂业'}, {'': '中国海洋石油'}, {'': '瑞声科技', 'sz000651': '格力电器', 'sh601398': '工商银行', 'sh600660': '福耀玻璃', 'sh600056': '中国医药'}, {'sz002047': '宝鹰股份', 'sh601668': '中国建筑', 'sz002146': '荣盛发展', 'sh600048': '保利地产', 'sz001979': '招商蛇口', 'sh600068': '葛洲坝', 'sz300197': '铁汉生态', 'sh600340': '华夏幸福', 'sh601997': '贵阳银行', 'sh600491': '龙元建设'}]

def count_stocks(labels, stocks):
	nlist = []
	exists = []
	reserved = []
	for label, stock in zip(labels, stocks):
		# if label[:2] in exists:
		# 	continue
		# else:
		# 	exists.append(label[:2])
		nlist.extend(stock.keys())

	scount = Series(nlist).value_counts()
	print(scount)
	res = scount[scount>1].index
	endtime = pd.datetime.today()
	starttime = endtime - BDay(4)
	starttime = starttime.strftime('%Y-%m-%d')
	endtime = endtime.strftime('%Y-%m-%d')

	for i in res:
		hist = ts.get_hist_data(code=i, start=starttime, end=endtime)
		# print(hist)
		print(i)
		if hist is not None:
			l = len(hist)
			if hist['close'].mean() < 10 and l > 3:
				# test = [hist['close'][i] > hist['close'][i-1] for i in range(1,4)]
				# if all(test):
				reserved.append(i)
	print(reserved)
if __name__ == '__main__':
	count_stocks(labels, stocks)